{"title":"L06: Pandas intro","markdown":{"yaml":{"title":"L06: Pandas intro"},"headingText":"Pandas DataFrames","containsRefs":false,"markdown":"\n\n\nAlmost all our data analysis in this course will be performed using a new data structure called Pandas DataFrames. These data structures are implemented in the Pandas package, which comes with the Anaconda installation. It is customary to import the Pandas package as below. \n\nThe Pandas package has a very rich functionality. In this course we will cover only a subset of what one can do with this package. If you are interested in a higher level of detail than what is covered in this course, I strongly recommend the official user guide for the package: \n\nhttps://pandas.pydata.org/docs/user_guide/index.html\n\nWe will be referencing different parts of this user guide at different points in the class. You are not expected to know all the details in the user guide, only the parts that are covered in class, or in the practice problems.\n\nThe pandas package comes with many different functions/attributes. We will introduce some of the more commonly used attributes gradually over the course of the semester. Remember, in Pyhton, an object attribute is anything that you can put (using dot notation) after the name of that object. We will use the terms \"attribute\", \"method\" and \"function\" interchangeably.\n\n# Creating dataframes with the \".DataFrame()\" function\n\nOne of the most important functions in the pandas package is the ``.DataFrame()`` function, which allows us to create a new dataframe (this is similar to using ``[]`` to create lists, and using ``{}`` to create dictionaries). \n\nThe general syntax for ``.DataFrame()`` is as follows:\n\n```python\npandas.DataFrame(data=None, index=None, columns=None, dtype=None, copy=None)\n```\n\nAs an aside, every time we introduce a new Pandas function, you should check its official documentation to see how you're supposed to use it. Usually, this is the first result if you Google \"pandas\" followed by the name of that function. For example, Google \"pandas DataFrame()\" and you should get this https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html as one of the first results. \n\nIf you imported pandas as pd (as above), you would replace \"pandas\" in the syntax above with \"pd\". \n\nFor example:\n\nThe cell above creates a new variable ``df`` of type ``pandas.core.frame.DataFrame``:\n\nTo print ``df``, we can use the ``print()`` function as usual:\n\nThough simply using the name of the dataframe also works, and the output looks nicer. We will use this method throughout the course:\n\nFrom the syntax of the ``.DataFrame()`` function, you should be able to tell that any of the three parameters of DataFrame can be omitted (because they all have default falues). \n\nFor example:\n\nFinally, if you check the documentation of ``.DataFrame()``, you will see that there are several different types of objects you can supply to each of its parameters. \n\nFor example, we could have created our initial dataframe ``df`` using a dictionary for the ``data`` parameter (instead of a list):\n\nNote how the ``columns`` parameter is missing, because column names are specified as the keys in the dictionary supplied to the ``data`` parameter.\n\nWe will not go through all the different ways to create a new dataframe. The key point is that **most Pandas functions offer a large degree of flexibility with respect to how they can be used**. This is very helpful for more advanced users, but it can be quite confusing for beginners. You can only get better at this with practice. Look at the documentation, and experiment with different ways to use that particular function. Check the results and see if you can explain what happened. \n\n**I will NOT expect you to know every little detail about the documentation of all the functions we introduce throughout the course**. But you should be able to use those functions in the form that I use them in the notes. For example, given the code above, I expect you to know how to create a new dataframe from a list (first approach at the top) and from a dictionary (see code cell right above this one). In the code below, I also show you how to use the ``numpy`` package to create a dataframe containing some randomly generate data (this comes in handy when you want to quickly generate an example dataframe to test some of your code, when the contents of the data don't really matter):\n\n# The structure of a DataFrame: index, columns, values \n\nThe syntax of the ``.DataFrame()`` function should make it clear what the main components of a dataframe are:\n\n- the index: the names of the rows (also referred to as axis 0 of the dataframe)\n- the columns: the names of the columns (also referred to as axis 1 of the dataframe)\n- the values: the data contained in the table itself\n\nWe can access each of these individual parts of the dataframe using the ``.index``, ``.columns`` and ``.values`` attributes:\n\nNote that these attributes are not followed by parentheses. They are still attributes, but they do not compute anything, they simply return some property of the dataframe. It is important to pay attention to these details. For example, the ``index`` attribute above is very different from the ``pd.Index()`` attribute (which is more appropriately called a \"function\"):https://pandas.pydata.org/docs/reference/api/pandas.Index.html. \n\nFinally, note that the data inside a dataframe is represented as a numpy array:\n\nAt this point in time, it is not important to know anything about the ``numpy`` package or the ``ndarray`` type that comes with it. I just wanted to point out a very important feature of the Python programming language: many packages are built using other existing packages (e.g. pandas uses the numpy and matplotlib packages to name a few).  \n\nThe **.info()** function gives us another way to quickly check the structure of our DataFrame:\n\nThe **.describe()** function gives us summary statistics for the numerical columns in the dataframe:\n\nThe **.dtypes** attribute tells us the data type for each column:\n\nThe **.shape** attribute tells us the shape of the dataframe:\n\n# Manipulating the index\n\n## ``.reset_index()``\n\nWe can switch to a numerical index for our dataframe using the ``.reset_index()`` function. \n\nSyntax:\n\n```python\nreset_index(level=None, drop=False, inplace=False, col_level=0, col_fill='')\n```\n\nFor example:\n\nNote how this pushed the old index inside the table itself, as a new column.\n\n**Very important**: the code above did not actually change ``df``:\n\nTo do that, we have to set the ``inplace`` parameter to True:\n\nOr we can simply re-write the ``df`` dataframe:\n\n## ``.set_index()``\n\nWe can use the data in one of the columns, as the new index of the table with the ``.set_index()`` function:\n\nSyntax:\n\n```python\nset_index(keys, drop=True, append=False, inplace=False, verify_integrity=False)\n```\n\nFor example:\n\nNote that, once we make the 'ticker' column into an index, it stops showing up as a column:\n\nSo if we try to set the index to 'ticker' again, we will get an error, because Python can not find the 'ticker' column:\n\n## ``.rename()``\n\nWe can rename one or more of the index values using the ``.rename()`` function.\n\nSyntax:\n```python\nrename(mapper=None, index=None, columns=None, axis=None, copy=True, inplace=False, level=None, errors='ignore')\n```\n\nWe will supply a dictionary to the ``index`` parameter, where the keys are the current names we want to change in the index, and the values are the new names we want to use.\n\nFor example:\n\nAs with ``.set_index()``, ``.rename()`` does not actually change the ``df`` dataframe unless we set ``inplace = True`` or we redefine the df variable. This behavior should be expected of any pandas function that has an ``inplace`` parameter:\n\n# Manipulating columns\n\nLet's rewrite ``df`` to make sure we're on the same page at this point:\n\n## ``.rename()``\n\nWe can also rename one or more of the *columns* using the ``.rename()`` function.\n\nThis time, we will supply a dictionary to the ``columns`` parameter, where the keys are the current names of the columns we want to change, and the values are the new names we want to use.\n\nFor example\n\n## Accessing and creating entire columns\n\nWe can access the data in an entire column of a dataframe using square brackets after the dataframe name:\n\nIf we want to access multiple columns at once, we have to put their names in a list:\n\nWe can create new columns by just supplying the data manually:\n\nBut most of the time, new columns will be created by bringing them over from other dataframes (we'll cover this in a future lecture) or by some calculation involving other existing columns from the dataframe.\n\nFor example:\n\n# Some common Pandas functions\n\nIn this section, we introduce some more Pandas functions that are very commonly used. These are very intuitive so we will not present the syntax for each of them. For the most part, it is very clear what these functions do, just from their name. We will cover many more such functions throughout the course.\n\nFirst, let's create an example dataframe with random integers:\n\nCount number of non-missing values:\n\nCalculate means, medians, standard deviations and variances:\n\nCalculate percentage changes from one row to the next:\n\nCalculate differences between the current row and a different row (default is the prior row):\n\nCalculate cumulative sums (sum of values up to that row):\n\nCalculate cummulative products (product of values up to that row):\n\n# Pandas Series\n\nThe pandas package comes with another commonly used data structure: the Series. This is a data structure that contains a single column and an index.\n\nFor example:\n\nWe will almost never use Series in our analysis. We only introduce it here because some pandas functions return a Series as a result. For the most part, we will convert series to dataframes using the ``.to_frame()`` function: \n","srcMarkdownNoYaml":"\n\n# Pandas DataFrames\n\nAlmost all our data analysis in this course will be performed using a new data structure called Pandas DataFrames. These data structures are implemented in the Pandas package, which comes with the Anaconda installation. It is customary to import the Pandas package as below. \n\nThe Pandas package has a very rich functionality. In this course we will cover only a subset of what one can do with this package. If you are interested in a higher level of detail than what is covered in this course, I strongly recommend the official user guide for the package: \n\nhttps://pandas.pydata.org/docs/user_guide/index.html\n\nWe will be referencing different parts of this user guide at different points in the class. You are not expected to know all the details in the user guide, only the parts that are covered in class, or in the practice problems.\n\nThe pandas package comes with many different functions/attributes. We will introduce some of the more commonly used attributes gradually over the course of the semester. Remember, in Pyhton, an object attribute is anything that you can put (using dot notation) after the name of that object. We will use the terms \"attribute\", \"method\" and \"function\" interchangeably.\n\n# Creating dataframes with the \".DataFrame()\" function\n\nOne of the most important functions in the pandas package is the ``.DataFrame()`` function, which allows us to create a new dataframe (this is similar to using ``[]`` to create lists, and using ``{}`` to create dictionaries). \n\nThe general syntax for ``.DataFrame()`` is as follows:\n\n```python\npandas.DataFrame(data=None, index=None, columns=None, dtype=None, copy=None)\n```\n\nAs an aside, every time we introduce a new Pandas function, you should check its official documentation to see how you're supposed to use it. Usually, this is the first result if you Google \"pandas\" followed by the name of that function. For example, Google \"pandas DataFrame()\" and you should get this https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html as one of the first results. \n\nIf you imported pandas as pd (as above), you would replace \"pandas\" in the syntax above with \"pd\". \n\nFor example:\n\nThe cell above creates a new variable ``df`` of type ``pandas.core.frame.DataFrame``:\n\nTo print ``df``, we can use the ``print()`` function as usual:\n\nThough simply using the name of the dataframe also works, and the output looks nicer. We will use this method throughout the course:\n\nFrom the syntax of the ``.DataFrame()`` function, you should be able to tell that any of the three parameters of DataFrame can be omitted (because they all have default falues). \n\nFor example:\n\nFinally, if you check the documentation of ``.DataFrame()``, you will see that there are several different types of objects you can supply to each of its parameters. \n\nFor example, we could have created our initial dataframe ``df`` using a dictionary for the ``data`` parameter (instead of a list):\n\nNote how the ``columns`` parameter is missing, because column names are specified as the keys in the dictionary supplied to the ``data`` parameter.\n\nWe will not go through all the different ways to create a new dataframe. The key point is that **most Pandas functions offer a large degree of flexibility with respect to how they can be used**. This is very helpful for more advanced users, but it can be quite confusing for beginners. You can only get better at this with practice. Look at the documentation, and experiment with different ways to use that particular function. Check the results and see if you can explain what happened. \n\n**I will NOT expect you to know every little detail about the documentation of all the functions we introduce throughout the course**. But you should be able to use those functions in the form that I use them in the notes. For example, given the code above, I expect you to know how to create a new dataframe from a list (first approach at the top) and from a dictionary (see code cell right above this one). In the code below, I also show you how to use the ``numpy`` package to create a dataframe containing some randomly generate data (this comes in handy when you want to quickly generate an example dataframe to test some of your code, when the contents of the data don't really matter):\n\n# The structure of a DataFrame: index, columns, values \n\nThe syntax of the ``.DataFrame()`` function should make it clear what the main components of a dataframe are:\n\n- the index: the names of the rows (also referred to as axis 0 of the dataframe)\n- the columns: the names of the columns (also referred to as axis 1 of the dataframe)\n- the values: the data contained in the table itself\n\nWe can access each of these individual parts of the dataframe using the ``.index``, ``.columns`` and ``.values`` attributes:\n\nNote that these attributes are not followed by parentheses. They are still attributes, but they do not compute anything, they simply return some property of the dataframe. It is important to pay attention to these details. For example, the ``index`` attribute above is very different from the ``pd.Index()`` attribute (which is more appropriately called a \"function\"):https://pandas.pydata.org/docs/reference/api/pandas.Index.html. \n\nFinally, note that the data inside a dataframe is represented as a numpy array:\n\nAt this point in time, it is not important to know anything about the ``numpy`` package or the ``ndarray`` type that comes with it. I just wanted to point out a very important feature of the Python programming language: many packages are built using other existing packages (e.g. pandas uses the numpy and matplotlib packages to name a few).  \n\nThe **.info()** function gives us another way to quickly check the structure of our DataFrame:\n\nThe **.describe()** function gives us summary statistics for the numerical columns in the dataframe:\n\nThe **.dtypes** attribute tells us the data type for each column:\n\nThe **.shape** attribute tells us the shape of the dataframe:\n\n# Manipulating the index\n\n## ``.reset_index()``\n\nWe can switch to a numerical index for our dataframe using the ``.reset_index()`` function. \n\nSyntax:\n\n```python\nreset_index(level=None, drop=False, inplace=False, col_level=0, col_fill='')\n```\n\nFor example:\n\nNote how this pushed the old index inside the table itself, as a new column.\n\n**Very important**: the code above did not actually change ``df``:\n\nTo do that, we have to set the ``inplace`` parameter to True:\n\nOr we can simply re-write the ``df`` dataframe:\n\n## ``.set_index()``\n\nWe can use the data in one of the columns, as the new index of the table with the ``.set_index()`` function:\n\nSyntax:\n\n```python\nset_index(keys, drop=True, append=False, inplace=False, verify_integrity=False)\n```\n\nFor example:\n\nNote that, once we make the 'ticker' column into an index, it stops showing up as a column:\n\nSo if we try to set the index to 'ticker' again, we will get an error, because Python can not find the 'ticker' column:\n\n## ``.rename()``\n\nWe can rename one or more of the index values using the ``.rename()`` function.\n\nSyntax:\n```python\nrename(mapper=None, index=None, columns=None, axis=None, copy=True, inplace=False, level=None, errors='ignore')\n```\n\nWe will supply a dictionary to the ``index`` parameter, where the keys are the current names we want to change in the index, and the values are the new names we want to use.\n\nFor example:\n\nAs with ``.set_index()``, ``.rename()`` does not actually change the ``df`` dataframe unless we set ``inplace = True`` or we redefine the df variable. This behavior should be expected of any pandas function that has an ``inplace`` parameter:\n\n# Manipulating columns\n\nLet's rewrite ``df`` to make sure we're on the same page at this point:\n\n## ``.rename()``\n\nWe can also rename one or more of the *columns* using the ``.rename()`` function.\n\nThis time, we will supply a dictionary to the ``columns`` parameter, where the keys are the current names of the columns we want to change, and the values are the new names we want to use.\n\nFor example\n\n## Accessing and creating entire columns\n\nWe can access the data in an entire column of a dataframe using square brackets after the dataframe name:\n\nIf we want to access multiple columns at once, we have to put their names in a list:\n\nWe can create new columns by just supplying the data manually:\n\nBut most of the time, new columns will be created by bringing them over from other dataframes (we'll cover this in a future lecture) or by some calculation involving other existing columns from the dataframe.\n\nFor example:\n\n# Some common Pandas functions\n\nIn this section, we introduce some more Pandas functions that are very commonly used. These are very intuitive so we will not present the syntax for each of them. For the most part, it is very clear what these functions do, just from their name. We will cover many more such functions throughout the course.\n\nFirst, let's create an example dataframe with random integers:\n\nCount number of non-missing values:\n\nCalculate means, medians, standard deviations and variances:\n\nCalculate percentage changes from one row to the next:\n\nCalculate differences between the current row and a different row (default is the prior row):\n\nCalculate cumulative sums (sum of values up to that row):\n\nCalculate cummulative products (product of values up to that row):\n\n# Pandas Series\n\nThe pandas package comes with another commonly used data structure: the Series. This is a data structure that contains a single column and an index.\n\nFor example:\n\nWe will almost never use Series in our analysis. We only introduce it here because some pandas functions return a Series as a result. For the most part, we will convert series to dataframes using the ``.to_frame()`` function: \n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"output-file":"lecture06_pandas_intro.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.361","theme":"zephyr","page-layout":"full","grid":{"sidebar-width":"400px"},"title":"L06: Pandas intro"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}